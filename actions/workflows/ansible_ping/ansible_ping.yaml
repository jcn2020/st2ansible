---
version: 1.0
description: quick demo of ansible

input:
  - private_keypath
  - inventory_file

output:
  - results: nil

tasks:
  say_hello:
    action: core.local
    input:
      cmd: "pwd && cd /opt/stackstorm/packs/sre__ansible_automation/artifacts && ls -altr"
    next:
      - when: <% succeeded() %>
        do:
          - set_results

  set_results:
    action: core.noop
    next: 
      - when: <% succeeded() %> 
        publish:
          results: <% task(say_hello).stdout %>
      - when: <% failed() %> 
        publish: 
          results: "Task failed, no output available"

      



